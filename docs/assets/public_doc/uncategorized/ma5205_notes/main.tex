\documentclass{report}

\input{header}

\title{ma5205 - measure and integral}
\author{Nguyen Ngoc Khanh}
\date{September 2023}

\begin{document}

\maketitle

\chapter{Measurable Space}

\section{Measurable Space}

In $\R$, we define the volume of an interval to be the length of it. That is, if a closed \footnote{similarly for other types of interval} interval is of the form $I = [a, b]$, then its length is $b - a$. Additionally, we want several properties such as: \textit{additivity}, i.e. if a set is a disjoint union of intervals then the volume of that set is the sum of volumes of the intervals, \textit{complement}, i.e. if a set has volume then the complement also has. It leads to the definitions of $\sigma$-algebra and measure.

\begin{definition}[$\sigma$-algebra]
    Let $X$ be an arbitrary set, $M$ is said to be a $\sigma$-algebra on $X$ if $M$ consists of subsets of $X$ with properties as follows:
    \begin{itemize}
        \item $\emptyset, X \in M$
        \item $U \in M \implies X \setminus U \in M$ (complement)
        \item $U_1, U_2, ... \in M \implies \bigcup_{k \in \N} U_k \in M$ (countable union\footnote{or $\sigma$-union})
    \end{itemize}
\end{definition}

\begin{definition}[Measurable Space]
    Let $X$ be an arbitrary set and a $\sigma$-algebra $M$ defined on $X$. A function $\mu: M \to [0, +\infty]$ is called measure if $\mu(\emptyset) = 0$ and given a countable collection of disjoint sets $U_1, U_2, ... \in M$ then $\mu(\bigcup_{k \in \N} U_k) = \sum_{k \in \N} \mu(U_k)$. The triplet $(X, M, \mu)$ is called a measurable space. A set $U \in M$ is called a measurable set.
\end{definition}

\section{Basis of a Measurable Space}

Given an arbitrary collection of $\sigma$-algebras, the union and intersection are also $\sigma$-algebras. That enables us to talk about $\sigma$-algebra generated by a basis.

\begin{definition}[$\sigma$-algebra generated by basis]
    Let $X$ be an arbitrary set and $B$ be a collection of subsets of $X$. Define $\sigma(B)$ to be the smallest $\sigma$-algebra containing $B$, that is the intersection of all $\sigma$-algebra containing $B$. $\sigma(B)$ is also said to be the $\sigma$-algebra generated by $B$.
\end{definition}

\begin{definition}[Basis of a $\sigma$-algebra]
    Let $X$ be an arbitrary set and $M$ be a $\sigma$-algebra on $X$. A subset $B$ of $M$ is said to be a basis of $M$ if $M = \sigma(B)$
\end{definition}

As discussed earlier, to define volume of a set in $\R$, we will construct a $\sigma$-algebra consisting all open intervals on $\R$ as follows

\begin{definition}[Borel $\sigma$-algebra or Borel algebra]
    Let $(X, \Tau)$ be a topological space, the Borel $\sigma$-algebra on $X$, denoted by $\Borel(X)$ is the smallest $\sigma$-algebra defined on $X$ containing all open sets.
\end{definition}

The Borel Measurable Space is then defined as 

\begin{definition}[Borel Measurable Space on $\R^n$]
    $(\R^n, \Borel(\R^n), \mu)$ is the Borel Measurable Space on $\R^n$ if $\mu$ is defined by the volume of $n$-intervals.
    \[
        \mu\left(\prod_{k=1}^n [a_k, b_k]\right) = \prod_{k=1}^n (b_k - a_k)
    \]
\end{definition}

\section{Subspace of a Measurable Space}

\begin{definition}[Subspace of a Measurable Space]
    Let $(X, M, \mu)$ be a measurable space and $E \in M$. Define the subspace $(E, M_E, \mu_E)$ by the restriction of $M$ and $\mu$ as follows
    \begin{itemize}
        \item $M_E = \{U \in M: U \subseteq E \}$
        \item $\mu_E(U) = \mu(U)$ if $U \in M_E$
    \end{itemize}
\end{definition}

\section{Complete Measurable Space}
\textcolor{red}{I haven't understood enough to give a reason for complete measurable space}

\begin{definition}[Outer Measure]
    Let $(X, M, \mu)$ be a measurable space. Define outer measure $\mu_e: \Power(X) \to [0, +\infty]$ by the infimum of the measure of all measurable covers
    \[
        \mu_e(E) = \inf \left\{ \mu(S): E \subseteq S \in M \right\}
    \]
\end{definition}

Outer Measure satisfies several properties

\begin{itemize}
    \item $A \subseteq B \implies |A|_e \leq |B|_e$ (subset)
    \item $\left| \bigcup_{k \in \N} E_k \right| \leq \sum_{k \in \N} |E_k|$ ($\sigma$-subadditivity)
\end{itemize}

\begin{definition}[Complete Measurable Space]
    
\end{definition}

\begin{definition}[Completion of a Measurable Space]
    
\end{definition}

\begin{definition}[Lebesgue Measurable Space] \footnote{can also defined as the unique non-trivial measurable space on $\R^n$ that translation invariant}
    Lebesgue Measurable Space on $\R^n$ is defined as the completion of the Borel Measurable Space on $\R^n$
\end{definition}

\section{Product Measure}

\begin{definition}[Product Measurable Space]
    Let $(X, M, \mu)$ and $(Y, N, \nu)$ be measurable spaces. Define the product measurable space as $(X \times Y, \sigma(M \times N), \mu \times \nu)$ where the product measure $\mu \times \nu$ is defined as
    \[
        (\mu \times \nu)(E_X \times E_Y) = \mu(E_X) \nu(E_Y)
    \]
    where $E_X \in M$ and $E_Y \in N$
\end{definition}

\section{Image Measure}


\chapter{Measurable Function}

\begin{definition}[Measurable Function]
    Let $(X, M, \mu)$ and $(Y, N, \nu)$ be measurable spaces. A function $f: X \to Y$ is said to be measurable if 
    \[
        E_Y \in N \implies f^{-1}(E_Y) \in M
    \]
\end{definition}

In this text, we are particularly interested in the case where $Y = [0, +\infty]$ as it is the foundation to define Lebesgue integral. Let's first define a topology on the totally ordered set $[0, +\infty]$

\begin{definition}[Order Topology]
    Given a totally ordered set $(X, <)$, the order topology $\Tau$ on $X$ is defined by the basis consists of rays as follows
    \[
    B = \{ \{x: \in X: x < a\}: a \in X\} \cup \{ \{x: \in X: b < x\}: b \in X\}
    \]
\end{definition}

The Borel $\sigma$-algebra on $[0, +\infty]$ is now defined as follows

\begin{definition}[Measurable Function on Half Extended Real Line]
    Let $[0, +\infty]$ be equipped with the order topology. Define the Borel measurable space on $[0, +\infty]$ by $([0, +\infty], \Borel([0, +\infty]), \nu)$ where $\nu$ is defined by the length of intervals.
    Let $(X, M, \mu)$ be a measurable space. A function $f: X \to [0, +\infty]$ is said to be measurable if it is a measurable function to the Borel measurable space on $[0, +\infty]$.
\end{definition}

From now on, we will call \textit{Measurable Function on Half Extended Real Line} by \textit{Measurable Function} if there is no confusion. It is trivial to verify the proposition below.

\begin{proposition}
    Let $(X, M, \mu)$ be a measurable space. A function $f: X \to [0, +\infty]$ is measurable if and only if 
    \[
        f^{-1}(a, +\infty] \in M
    \]
    for all $a \in [0, +\infty]$
\end{proposition}

\chapter{Integration}

\section{Simple Function}
\begin{definition}[Indicator function]
    Let $E \subseteq X$, the indicator function of $E$ denoted by $\chi_{E}: X \to [0, +\infty]$ is defined by
    \[
        \chi_E(x) = \begin{cases}
            1 &\text{if $x \in E$} \\
            0 &\text{otherwise}
        \end{cases}
    \]
\end{definition}

\begin{definition}[Non-negative simple function]
    A function is said to be simple if the set image is finite set. A non-negative simple function $\phi: X \to [0, +\infty]$ can be written as
    \[
        \phi = \sum_{n=1}^N a_n \chi_{E_n}
    \]
    where $N \in \N$, $a_n \in [0, +\infty]$, $\{ E_n \}$ are pairwise disjoint, and $X = \bigcup_{n=1}^N E_n$
\end{definition}

\begin{definition}[Integral of a non-negative simple function]
    If $\phi = \sum_{n=1}^N a_n \chi_{E_n}$ is a non-negative simple function where $E_n$ are measurable w.r.t some measurable space $(X, M, \mu)$. We define the integral of $\phi$ as follows
    \[
        \int_X \phi = \sum_{n=1}^M a_n \mu(E_n)
    \]
\end{definition}

\begin{theorem}[Monotone sequence of simple functions]
    Given any $f: \R^n \to [0, +\infty]$, there exists a monotone increasing sequence of simple functions $\phi_k: \R^n \to [0, +\infty]$ that converges pointwise to $f$
\end{theorem}


\section{Integral of a non-negative function}
\begin{definition}[Integral of a non-negative function]
    Let $(X, M, \mu)$ be a measurable space and $f: X \to [0, +\infty]$ be measurable. The integral of $f$ is defined as
    \[
        \int_{X} f d\mu = \sup \left\{ \int_{X} g d\mu : g \leq f \right\}
    \]
\end{definition}

\begin{definition}[Lebesgue integral of a non-negative function]
    Let $(\R^n, M, \mu)$ be the Lebesgue measurable space on $\R^n$ and $f: \R^n \to [0, +\infty]$ be measurable. The Lebesgue integral of $f$ is defined as
    \[
        \int_{\R^n} f d\mu = \sup \left\{ \int_{\R^n} \phi d\mu : \phi \leq f, \phi \text{ is simple} \right\}
    \]
\end{definition}

\begin{proposition}[Area under the graph]
    Let $(\R^n, M, \mu)$ be the Lebesgue measurable space on $\R^n$ and $f: \R^n \to [0, +\infty]$ be measurable. Define the set under $f$ as follows
    \[
        R(f) = \{(x, y) \in \R^n \times \R: 0 \leq y < f(x) \}
    \]
    Then,
    \[
        \mu(R(f)) = \int_{\R^n} f d\mu
    \]
\end{proposition}

\begin{definition}[Integral of arbitrary function]
    Let $(\R^n, M, \mu)$ be the Lebesgue measurable space on $\R^n$ and $f: \R^n \to [-\infty, +\infty]$ be measurable. The Lebesgue integral of $f$ is defined as
    \[
        \int_{\R^n} f d\mu = \int_{\R^n} f^+ d\mu - \int_{\R^n} f^- d\mu
    \]
    if either $\int_{\R^n} f^+ d\mu$ and $\int_{\R^n} f^- d\mu$ is finite.
\end{definition}

\begin{proposition}[Linearity of Lebesgue integral]
    
\end{proposition}

\section{Convergence Theorems of a non-negative function}

\begin{proposition}[Monotone Convergence Theorem]
    
\end{proposition}

\begin{proposition}[Fatou Lemma]
    
\end{proposition}

\begin{theorem}[Lebesgue Dominated Convergence Theorem]
    
\end{theorem}



\section{Product Measure Theorems}
\begin{proposition}[Sectional Property]
    Let $(X, M_X, \mu_X), (Y, M_Y, \mu_Y)$ be measurable spaces. Given any $E \in \sigma(M_X \times M_Y)$. For almost every $x \in X$, the set $E_x = \{y \in Y: (x, y) \in E \} \in M_Y$
\end{proposition}

\begin{proposition}[Sectional Property for Lebesgue Measurable Space]
    Let $X = \R^m, Y = \R^n$, $E$ is a Lebesgue measurable set on $X \times Y$. For almost every $x \in X$, the set $E_x = \{y \in Y: (x, y) \in E \}$, namely section, is Lebesgue measurable on $Y$
\end{proposition}
    
\begin{theorem}[Fubini Theorem]
    Let $X = \R^m, Y = \R^n$. If $f: X \times Y \to [-\infty, +\infty]$ is Lebesgue integrable, i.e. $f \in L(X \times Y)$, then
    \begin{itemize}
        \item For almost every $x \in X$, function $f_x: Y \to [-\infty, +\infty]$ defined by $f_x(y) = f(x, y)$ is Lebesgue integrable, i.e $f_x \in L(Y)$
        \item Function $g(x): X \to (-\infty, +\infty)$ defined by $g(x) = \int_{Y} f_x(y) dy$ is Lebesgue integrable, i.e $g \in L(X)$
    \end{itemize}
    And
    \[
        \int_{X \times Y} f = \int_X \left[ \int_Y f_x(y) dy \right] dx
    \]
\end{theorem}

\section{Change of Variables}

\chapter{Lebesgue Differentiation Theorem}
\section{Vitali Covering Lemma}

\begin{lemma}[Zorn Lemma]
    Suppose a partially ordered set $P$ has the property that every chain in P has an upper bound in $P$. Then the set $P$ contains at least one maximal element. 
\end{lemma}

\begin{lemma}[Axiom of Choice]
    For any set $X$ of nonempty sets, there exists a choice function $f$ that is defined on $X$ and maps each set of $X$ to an element of that set. 
\end{lemma}

\begin{lemma}[Simple Vitali Covering Lemma]
    In a metric space, let $F$ be a collection of balls such that $\sup_{B \in F} r(B) = R < +\infty$, then there is a (countable in a separable metric space) subcollection $M$ of pairwise disjoint balls such that
    \[
        \bigcup_{B \in F} B \subseteq \bigcup_{B_k \in M} c B_k
    \]
    where $cB_k$ denotes the open ball constructed from $B_k$ by simple enlarging it $c$ times \footnote{$\{ x \in \R^n: ||x - x_0|| < r \} \mapsto \{ x \in \R^n: ||x - x_0|| < cr \}$ }.
\end{lemma}

Let $F$ be a collection of balls, define a partial order on the set of all disjoint collection of balls in $F_n$ as follows: let $A, B$ be any set of disjoint balls in $F_n$, define $A \leq B$ as $A \subseteq B$. Hence, any chain $\{A_i \in F: i \in I \}$ for any index set $I$, there is an upperbound $A = \bigcup_{i \in I} A_i$. By Zorn Lemma, $F$ has a maximal subcollection $M$ of disjoint balls.

Let $F_1$ be defined as follows

\[
    F_1 = \left\{B \in F: \frac{R}{2} < r(B) \leq R \right\}
\]

By Zorn Lemma, there is a maximal subcollection $M_1$ of disjoint balls in $F_1$. Similarly, let $M_n$ be a maximal subcollection of disjoint balls of $F_n$
\[
    F_n = \left\{B \in F: \frac{R}{2^{n+1}} < r(B) \leq \frac{R}{2^n} \text{ and } B \text{ does not intersect } M_1, M_2, ..., M_{n-1} \right\}
\]

Given any ball $B \in F$, we will prove that every point $b \in B$ is not too far off from $M = \bigcup_{n \in \N} M_n$. Suppose $\frac{R}{2^{n+1}} < r(B) \leq \frac{R}{2^n}$, then $B$ must intersect one of $M_1, M_2, ..., M_n$. If $B$ does not intersect $M_1, M_2, ..., M_{n-1}$, by the construction of $F_n$, $B \in F_n$. On the other hand, by maximality of $M_n$, $B$ intersects one of ball in $M_n$. Next, let $B_k \in M_k (k \leq n)$ intersects $B$, let $c_k, c$ denote the centers of $B_k$ and $B$. Then, for any $b \in B$, we have

\begin{align*}
    d(c_k, b)
    &\leq d(c_k, a) + d(a, c) + d(c, b) &\text{(let $a \in B_k \cap B$)}\\
    &\leq r(B_k) + r(B) + r(B) &\text{($a \in B_k, a \in B, b \in B$)}\\ 
    &\leq r(B_k) + 4 \frac{R}{2^{n+1}} &\text{$\left(r(B) \leq \frac{R}{2^n}\right)$}\\
    &\leq 5 r(B_k) &\text{$\left(\frac{R}{2^{n+1}} \leq \frac{R}{2^{k+1}} \leq r(B_k)\right)$}\\
\end{align*}

Hence, any point in any ball in $F$ is in one of the ball $5 B_k $ where $B_k \in M_k$, $k \in \N$. Let $M = \bigcup_{k \in \N} M_k$ given any two balls $B_m, B_n \in M$ with $m < n$, by the construction of $F_n$, $B_n \in M_n \subseteq F_n$ then $B_n$ does not intersect $B_m$. Hence, $M$ is a pairwise disjoint subcollection of $F$ and \footnote{we can make $c$ smaller by choosing finer partition of $R$}

\[
    \bigcup_{B \in F} B \subseteq \bigcup_{B_k \in M} 5B_k
\]

If the metric space is separable, let $M_Q = \{ Q \cap B_k: B_k \in M \}$ where $Q$ is a countable dense set. Each set in $M_Q$ is non-empty and pairwise disjoint, hence is there a bijection from $M$ to $M_Q$ by Axiom of Choice. Hence, $M$ is countable.

\begin{lemma}[Simple Vitali Covering Lemma for Lebesgue measure]
    Let $E \subseteq \R^n$ with $\mu_e(E) < +\infty$, let $F$ be a collection of balls covering $E$, then for any $0 < \epsilon < \mu_e(E)$, there is a countable subcollection $M$ of pairwise disjoint balls such that
    \[
        \sum_{B_k \in M} \mu(B_k) \geq \beta \mu_e(E)
    \]

    
\end{lemma}
Let $F_n = \{B \in F: r(B) < n\}$, then $(\overline{F_1} \cap E) \subseteq (\overline{F_2} \cap E) \subseteq ...$ and $\left( \bigcup_{n \in \N} (\overline{F_n} \cap E) \right) = E$ where $\overline{F_n} = \bigcup_{B \in F_n} B$, hence \footnote{By Theorem 3.27, Richard L. Wheeden - Antoni Zygmund - Measure and Integral: An Introduction to Real Analysis - Second Edition}, $\mu_e(E) = \lim_{n \to +\infty} \mu_e(\overline{F_n} \cap E)$. Therefore, given any $\epsilon > 0$, there exists $n \in \N$ such that $\mu_e(E) - \epsilon < \mu_e(\overline{F_n} \cap E)$. By Simple Vitali Covering Lemma on $F_n$ of bounded radius. there is a countable collection $M$ of balls such that

\[
    \bigcup_{B \in F_n} B \subseteq \bigcup_{B_k \in M} cB_k
\]

Hence, 
\begin{align*}
    c^n \sum_{B_k \in M} \mu(B_k)
    &\geq \mu_e\left(\bigcup_{B \in F_n} B \right) \\
    &\geq \mu_e(\overline{F_n} \cap E) \\
    &\geq \mu_e(E) - \epsilon \\
\end{align*}

Write $M = \bigcup_{k=1}^{+\infty} B_k$, then $\lim_{N \to +\infty} \sum_{k=1}^N \mu(B_k) = \mu(M) \geq \frac{1}{c^n} (\mu_e(E) - \epsilon)$. Choose appropriate $\epsilon$, there exists $N \in \N$ such that 
\[
    \sum_{k=1}^N \mu(B_k) \geq \beta \mu_e(E)
\]
where $\beta > 0$

Given any $\epsilon > 0$, choose an open set $G \supseteq E$ such that $\mu_e(E) \leq \mu(G) < \mu_e(E) + \epsilon$. If the first condition satisfies, the second is immediate.

Let $G_1 = G, E_1 = E$. Let $\mathcal{V}_1$ be constructed by discarding all closed balls in $\mathcal{V}$ that are not contained in $G_1$. As $\mathcal{V}$ finely covers $E_1$ and $G_1$ is open, $\mathcal{V}_1$ still finely covers $E_1$ \footnote{A similar argument: for each $x \in G_1 \cap E$, choose one a sequence of decreasing closed balls containing $x$ that is contained in $G_1 \cap E$}. By Simple Vitali Covering Lemma for Lebesgue measure on $E$ with cover $\mathcal{V}_1$, there is a countable subcollection $M_1 \subseteq \mathcal{V}_1$ such that

\[
    \sum_{B_i \in M_1} \mu(B_i) \geq \beta \mu_e(E)
\]


Then,
\begin{align*}
    \mu\left( E_1 \setminus \overline{M_1} \right)
    &\leq \mu\left( G_1 \setminus \overline{M_1} \right) \\
    &= \mu(G_1) - \sum_{B_i \in M_1} \mu(B_i) &\text{(balls in $M_1$ are are contained in $G_1$)} \\
    &< (1 - \beta) \mu_e(E_1) + \epsilon \\
    &< (1 - \beta/2) \mu_e(E_1) &\text{(choose $0 < \epsilon < \beta \mu_e(E_1) /2$)} 
\end{align*}

Let $M^{(k-1)} = \bigcup_{i=1}^{k-1} \overline{M_i}$ where $\overline{M_i} = \bigcup_{B \in M_i} B$. Similarly, Let $G_k = G \setminus M^{(k-1)}, E_k = E \setminus M^{(k-1)}$  be the remaining set after choosing $k-1$ finite subcollection $M_i$. Construct $V_k$ by discarding all closed balls in $\mathcal{V}$ that are not contained in $G_k$. As $\mathcal{V}$ finely covers $E_k$ and $G_k$ is open, $\mathcal{V}_k$ still finely covers $E_k$. Simple Vitali Covering Lemma for Lebesgue measure on $E \setminus M^{(k-1)}$ with cover $\mathcal{V}_1$, there is a countable subcollection $M_k \subseteq \mathcal{V}_k$ such that

\[
    \sum_{B_i \in M_k} \mu(B_i) \geq \beta \mu_e(E_k)
\]

Then, note that $\mu(G_k) = \mu(G) - \mu(M^{(k-1)}) < [\mu_e(E) - \mu(M^{(k-1)})] + \epsilon \leq \mu_e(E_k) + \epsilon$
\begin{align*}
    \mu_e(E_{k+1}) = \mu_e\left( E_k \setminus \overline{M_k} \right)
    &\leq \mu\left( G_k \setminus \overline{M_k} \right) \\
    &= \mu(G_k) - \sum_{B_i \in M_k} \mu(B_i) &\text{(balls in $M_k$ are are contained in $G_k$)} \\
    &< (1 - \beta/2) \mu_e(E_1)
\end{align*}

Therefore,
\[
    \mu(E_k) < (1 - \beta/2)^{k-1} \mu(E)
\]

Put $M = \bigcup_{k \in \N} M_k$, we have $(E \cap M^{(1)}) \subseteq (E \cap M^{(2)}) \subseteq ...$, and $\bigcup_{k} (E \cap M^{(k)}) = E \cap \overline{M}$
Then, \footnote{By Theorem 3.27, Richard L. Wheeden - Antoni Zygmund - Measure and Integral: An Introduction to Real Analysis - Second Edition}

\begin{align*}
    \mu_e(E \cap \overline{M})
    &= \lim_{k \to +\infty} \mu_e(E \cap M^{(k)}) \\
    &= \lim_{k \to +\infty} [\mu_e(E) - \mu(E \setminus M^{(k)})] &\text{(Caratheodory criterion)} \\
    &= \mu_e(E) - \lim_{k \to +\infty}  \mu(E \setminus M^{(k)}) \\
    &= \mu_e(E)
\end{align*}

Hence, $\mu_e(E \setminus \overline{M}) = \mu_e(E) - \mu_e(E \cap \overline{M}) = 0$


\section{Lebesgue Differentiation Theorem}

\begin{lemma}[Hardy-Littlewood Maximal Function]
    Given a Lebesgue measurable function $f: \R^n \to \R$, Hardy-Littlewood maximal function defined on ball is as follows
    \[
        f^*(x) = \sup_{\text{$r > 0$}} \frac{1}{\mu(\Ball_r(x))} \int_{\Ball_r(x)} |f(y)|dy
    \]
    Some properties of Hardy-Littlewood maximal function:
    \begin{enumerate}
        \item $f^*$ is lower semicontinuous, i.e. $E_t = \{x \in \R^n: f^*(x) > t \}$ is open for all $t \in \R$
        \item $\mu(E_t) \leq \frac{c}{t} \int_{\R^n} |f(y)|dy$ where $c \in \R$ 
    \end{enumerate}
\end{lemma}

(Part 1) Given any $\alpha > 0$, let $x_1 \in E_t = \{x \in \R^n: f^*(x) > t \}$ that is, there exists $r > 0$ such that 
\[
    \frac{1}{\mu(\Ball_r(x_1))} \int_{\Ball_r(x_1)} |f(y)|dy > \alpha t
\]
where $\alpha > 1$. We will prove that there exists an open ball $\Ball_\epsilon(x_1)$ such that for every $x_2 \in \Ball_\epsilon(x_1)$, $f^*(x_2) > t$, that implies the set $E_t$ is open.

Let $\epsilon > 0$, for any $x_2 \in \Ball_\epsilon(x_1)$, then $\Ball_r(x_1) \subseteq \Ball_{r + \epsilon}(x_2)$. Therefore

\begin{align*}
    t
    &< \frac{1}{\alpha} \frac{1}{\mu(\Ball_r(x_1))} \int_{\Ball_r(x_1)} |f(y)|dy \\
    &\leq \frac{1}{\alpha} \frac{\mu(\Ball_{r + \epsilon}(x_2))}{\mu(\Ball_r(x_1))} \frac{1}{\mu(\Ball_{r + \epsilon}(x_2))} \int_{\Ball_{r + \epsilon}(x_2)} |f(y)|dy
\end{align*}

Choose $\epsilon$ small enough such that $\frac{\mu(\Ball_{r + \epsilon}(x_2))}{\mu(\Ball_r(x_1))} < \alpha$, then 

\[
    \frac{1}{\mu(\Ball_{r + \epsilon}(x_2))} \int_{\Ball_{r + \epsilon}(x_2)} |f(y)|dy > t
\]

That is, $f^*(x_2) > t$. Hence, there exists $\epsilon > 0$ such that for all $x_2 \in \Ball_\epsilon(x_1)$, $f^*(x_2) > t$. $E_t$ is open for any $t$.

(Part 2) For each $x \in E_t$, let $B_x$ be a ball centered at $x$ such that $\frac{1}{\mu(B_x)} \int_{B_x} |f(y)|dy > t$. The collection $\{B_x: x \in E_t \}$ covered $E_t$, by Vitali Covering Lemma, given any $\epsilon > 0$, there is a finite subcollection $M_\epsilon$ of pairwise disjoint $B_k$ such that
\[
    \sum_{B_k \in M_\epsilon} \mu(B_k) \geq \frac{1}{5} \mu(E_t) - \epsilon
\]

Therefore,
\begin{align*}
    \mu(E_t)
    &\leq 5 \sum_{B_k \in M_\epsilon} \mu(B_k) + 5\epsilon \\
    &< 5 \sum_{B_k \in M_\epsilon} \left( \frac{1}{t} \int_{B_k} |f(y)|dy \right) + 5\epsilon &\text{(by construction of $B_k$)} \\
    &\leq \frac{5}{t} \int_{\R^n} |f(y)|dy + 5\epsilon &\text{($B_k$ pairwise disjoint)} \\
\end{align*}

The statement is true for all $\epsilon > 0$, hence
\[
    \mu(E_t) \leq \frac{5}{t} \int_{\R^n} |f(y)|dy
\]

\begin{lemma}[Density of Continuous Function]
    Given $f \in L(\R^n)$ and any $\epsilon > 0$, there exists a continous function $g$ with compact support \footnote{support of $f: X \to \R$ is $\{x \in X: f(x) \neq 0 \}$} such that
    \[
        \int_{\R^n} |f(x) - g(x)| dx < \epsilon
    \]
\end{lemma}

\begin{theorem}[Lebesgue Differentiation Theorem]
    Given $f \in L(\R^n)$, then for almost every $x \in \R^n$ 
    \[
        \limsup_{B \searrow x} \left| \frac{F(B)}{|B|} - f(x) \right| = \limsup_{B \searrow x} \frac{1}{\mu(B)} \left| \int_B [f(y) - f(x)]dy \right| = 0
    \]
    where $B \searrow x$ denotes $B = \Ball_r(x)$ and $r \to 0^+$, $F(B) = \int_B f(y) dyt$
\end{theorem}

Let $D_t$ be defined as
\[
    D_t = \left\{ x \in \R^n: \limsup_{B \searrow x}  \frac{1}{\mu(B)} \left| \int_B [f(y) - f(x)]dy \right| > t \right\}
\]

We will prove that $\mu_e(D_t) = 0$ for all $t > 0$, that will conclude the Lebesgue Differentiation Theorem.

Let $g$ be a continous function, and any ball $B$ centers at $x$, then
\begin{align*}
    \left| \int_B [f(y) - f(x)] dy\right|
    &\leq \int_B |f(y) - f(x)| dy \\
    &\leq  \int_B |f(y) - g(y)| dy + \int_B |g(y) - g(x)| dy + \mu(B) |g(x) - f(x)| \\
\end{align*}

Hence,
\begin{align*}
    \limsup_{B \searrow x} \frac{1}{\mu(B)} \left| \int_B [f(y) - f(x)] dy\right|
    &\leq \limsup_{B \searrow x} \frac{1}{\mu(B)} \left(\int_B |f(y) - g(y)| dy + \int_B |g(y) - g(x)| dy + \mu(B) |g(x) - f(x)| \right) \\
    &\leq \limsup_{B \searrow x} \frac{1}{\mu(B)} \int_B |f(y) - g(y)| dy + \limsup_{B \searrow x} \frac{1}{\mu(B)} \int_B |g(y) - g(x)| dy + \limsup_{B \searrow x} |g(x) - f(x)| \\
\end{align*}

As $g$ is continuous, $\limsup_{B \searrow x} \frac{1}{\mu(B)} \int_B |g(y) - g(x)| dy = 0$, then 
\begin{align*}
    \limsup_{B \searrow x} \frac{1}{\mu(B)} \left| \int_B [f(y) - f(x)] dy\right|
    &\leq \limsup_{B \searrow x} \frac{1}{\mu(B)} \int_B |f(y) - g(y)| dy + |g(x) - f(x)| \\
    &\leq \sup_{B} \frac{1}{\mu(B)} \int_B |f(y) - g(y)| dy + |g(x) - f(x)| \\
    &= (f-g)^*(x) + |g(x) - f(x)| \\
\end{align*}

Therefore,

\[
    D_t \leq \left\{ x \in \R^n: (f - g)^*(x) > \frac{t}{2} \right\} \cup \left\{ x \in \R^n: |g(x) - f(x)| > \frac{t}{2} \right\}
\]

As the two sets are measurable

\[
    \mu_e(D_t) \leq \mu\left(\left\{ x \in \R^n: (f - g)^*(x) > \frac{t}{2} \right\} \right) + \mu\left(\left\{ x \in \R^n: |g(x) - f(x)| > \frac{t}{2} \right\}\right)
\]

By property of Hardy-Littlewood maximal function, 

\[
    \mu\left(\left\{ x \in \R^n: (f - g)^*(x) > \frac{t}{2} \right\} \right) \leq \frac{2c}{t} \int_{\R^n} |f(y) - g(y)| dy
\]

By Chebyshev inequality,
\[
    \mu\left(\left\{ x \in \R^n: |g(x) - f(x)| > \frac{t}{2} \right\}\right) \leq \frac{2}{t} \int_{\R^n} |f(y) - g(y)| dy
\]

Therefore,

\[
    \mu_e(D_t) \leq \frac{2(c+1)}{t} \int_{\R^n} |f(y) - g(y)| dy
\]

Given any $t > 0$ and $\epsilon > 0$, we can choose $g$ close enough to $f$ such that $\int_{\R^n} |f(y) - g(y)| dy < \frac{t \epsilon}{2(c+1)}$, then $\mu_e(D_t) < \epsilon$. Hence $\mu_e(D_t) = 0$ for all $t > 0$. Then 
\[
    D = \left\{ x \in \R^n: \limsup_{B \searrow x}  \frac{1}{\mu(B)} \left| \int_B [f(y) - f(x)]dy \right| > 0 \right\} = \bigcup_{k \in \N} D_{1/k}
\]

Then $\mu_e(D) = 0$, that is $\limsup_{B \searrow x}  \frac{1}{\mu(B)} \left| \int_B [f(y) - f(x)]dy \right| = 0$ for almost every $x \in \R^n$

\section{Absolute Continuous Set Function}

\textcolor{red}{I wrote another pdf for this}

\chapter{Convex function}

\begin{definition}[Convex set]
    A set $C \in \R^n$ is said to be convex if for any $x, y \in C$, then $t x + (1-t) y \in C$ for all $t \in [0, 1]$
\end{definition}

\begin{definition}[Convex function]
    A function $f: C \to \R$ defined on a convex set $C \in \R^n$ is said to be a convex function if for any $x, y \in C$, then $f(t x + (1-t) y) \leq t f(x) + (1-t) f(y)$ for all $t \in [0, 1]$
\end{definition}

\begin{proposition}[The cone of convex functions]
    The set of convex functions form a cone
    \begin{itemize}
        \item $\phi_1 + \phi_2$ convex if $\phi_1$ and $\phi_2$ are convex
        \item $c \phi$ convex if $c > 0$ and $\phi$ convex
    \end{itemize}
\end{proposition}

\begin{proposition}[Completeness of convex functions]
    If $\phi_k, k=1, 2, ...$ convex and $\phi_k \to \phi$, then $\phi$ is convex
\end{proposition}

\begin{lemma}[Existence of supporting plane]
    Given a convex function $f: C \to \R$, $C \subseteq \R^n$, for any $x_0 \in C$, there exists a $n$-plane $p: \R^n \to \R$ such that $p(x) = f(x)$ for all $x \in C$. Moreover, $p$ can be chosen such that $p(x_0) = f(x_0)$
\end{lemma}

\begin{theorem}[Jensen Inequality]
    Given a measurable space $(X, M, \mu)$ with $\mu(X) = 1$ and $\mu$-measurable function $f: X \to \R$.
    Given a convex function $\phi: \R \to \R$, then $\phi(f)$ is $\mu$-measurable and
    \[
        \phi \left( \int_X f d\mu \right) \leq \int_X \phi(f) d\mu
    \]
\end{theorem}

Let $\gamma = \int_X f d\mu$ and $m$ be the slope of the supporting line at $(\gamma, \phi(\gamma))$, then for any $x \in X$

\[
    \phi(\gamma) + m (f(x) - \gamma) \leq \phi(f(x))
\]

Then 
\begin{align*}
    \int_X \phi(\gamma) d\mu + m \left(\int_X f(x) d\mu - \int_X \gamma d\mu \right)  &\leq \int_X \phi(f(x)) d\mu \\
    \mu(X) \phi(\gamma) + m \left(\gamma - \mu(X) \gamma \right)  &\leq \int_X \phi(f(x)) d\mu
\end{align*}

As $\mu(X) = 1$, yields the inequality.

If $\mu$ is the counting measure on a finite set, we have
\[
    \phi \left( \sum_{i=1}^n t_i f(x_i) \right) \leq  \left( \sum_{i=1}^n t_i \phi(f(x_i)) \right)
\]

for $t_1, t_2, ... \geq 0$ and $\sum_{i=1}^n t_i = 1$

\chapter{$L^p$ Space}

\section{$L^p$}

\begin{definition}[$L^p$]
    Given a measurable space $(X, M, \mu)$ and a $\mu$-measurable function $f: X \to [-\infty, +\infty]$. For any $0 < p \leq \infty$, define
    \begin{itemize}
        \item $||f||_p = \left( \int_X |f|^p d\mu \right)^{1/p}$
        \item $||f||_\infty = \inf \{ \alpha \in [-\infty, +\infty]: |\{x \in X: f(x) > \alpha \}| = 0 \}$
    \end{itemize}
    The set $L^p(E)$ is then defined as
    \[
        L^p(E) = \{ f \text{ is $\mu$-measurable, defined on $X$ }: ||f||_p < +\infty \}
    \]
\end{definition}

\begin{proposition}
    If $\mu(X) < +\infty$ then $||f||_\infty = \lim_{p \to \infty} ||f||_p$ 
\end{proposition}

Case 1: 

\textcolor{red}{not interesting}

Case 2: $\mu(X) > 0, ||f||_\infty > 0$
\begin{align*}
    ||f||_p
    &= \left(\int_X |f|^p \right)^{1/p} \\
    &\leq \left(\int_X ||f||_\infty^p \right)^{1/p} &\text{(let $p \geq 1$)}\\
    &= ||f||_\infty \mu(X)^{1/p}
\end{align*}
Then, $\lim_{p \to \infty} ||f||_p \leq ||f||_\infty$. On the other hand,

By definition, given any $M < ||f||_\infty$, then the set $A = \{ x \in X: |f(x)| > M \}$ has a positive $\mu$-measure, then 
\begin{align*}
    ||f||_p
    &= \left(\int_X |f|^p \right)^{1/p} \\
    &\geq \left(\int_A |f|^p \right)^{1/p} \\
    &\geq \left(\int_A M^p \right)^{1/p} \\
    &= M \mu(A)^{1/p}
\end{align*}

Fix $M$, $\lim_{p \to \infty} \mu(A)^{1/p} = 0$. Then, $\lim_{p \to \infty} ||f||_p \geq M$ for all $M < ||f||_\infty$. Hence,
\[
    ||f||_\infty = \lim_{p \to \infty} ||f||_p
\]

\begin{proposition}
    Given $\mu(X) < +\infty$, if $0 < p_1 < p_2 \leq +\infty$, then $L^{p_1} \supset L^{p_2}$
\end{proposition}

Case 1:

\textcolor{red}{not interesting}

Case 2: $\mu(X)$ finite and $p_2 < +\infty$

Jensen inequality
\[
    \phi \left( \frac{\int_X f^{p_1}}{\mu(X)} \right) \leq  \left( \frac{\int_X \phi(f^{p_1})}{\mu(X)} \right)
\]

Take $\phi(x) = x^{p_2/p_1}$, then

\[
    \left( \frac{\int_X f^{p_1}}{\mu(X)} \right)^{p_2/p_1} \leq  \frac{\int_X f^{p_2}}{\mu(X)}
\]

If $f \in L^{p_2}$, the LHS = RHS finite

\begin{proposition}[Vector Space of $L^p$]
    $L^p$ for $0 < p \leq +\infty$ forms a vector space over the field of complex numbers
    \begin{itemize}
        \item $f + g \in L^p$ if $f, g \in L^p$
        \item $cf \in L^p$ if $c \in \C$ and $f \in L^p$
    \end{itemize}
\end{proposition}

\begin{proposition}[Continuity of $L^p(\R^n)$]
    If $f \in L^p(\R^n), 1 \leq p < +\infty$, then
    \[
        \lim_{|h| \to 0} ||f(x + h) - f(x)||_p = 0
    \]
\end{proposition}

\textcolor{red}{to}

\section{Holder Inequality and Minkowski Inequality}

\begin{lemma}[Young Inequality]
    Given $c > 0$, let $\phi: [0, c] \to \R$ be a continuous, strictly increasing function with $\phi(0) = 0$, then it is a bijection from $[0, c]$ into $[0, \phi(c)]$. Moreover, given any $a \in [0, c]$ and $b \in [0, \phi(c)]$, then
    \[
        ab \leq \int_0^a \phi + \int_0^b \phi^{-1}
    \]
    The equality holds if $(a, b)$ lies on the graph of $\phi$, i.e. $b = \phi(a)$
\end{lemma}

First, we write $\int_0^b \phi^{-1}$ in term of integral of $\phi$.

\begin{align*}
    \int_0^b \phi^{-1}
    &= |\{ (y, x) \in [0, b] \times [0, \phi^{-1}(b)]: x < \phi^{-1}(y) \}| \\
    &= |\{ (x, y) \in [0, \phi^{-1}(b)] \times [0, b]: \phi(x) < y \}| \\
    &= |[0, \phi^{-1}(b)] \times [0, b]| - |\{ (x, y) \in [0, \phi^{-1}(b)] \times [0, b]: y < \phi(x) \}| \\
    &= b \phi^{-1}(b) - \int_0^{\phi^{-1}(b)} \phi
\end{align*}

Case 1: $\phi^{-1}(b) \leq a$

\begin{align*}
    \int_0^a \phi + \int_0^b \phi^{-1}
    &= \int_{\phi^{-1}(b)}^a \phi + b \phi^{-1}(b) \\
    &\geq \int_{\phi^{-1}(b)}^a b + b \phi^{-1}(b) \\
    &= ab
\end{align*}

Case 2: $\phi^{-1}(b) \geq a$
\begin{align*}
    \int_0^a \phi + \int_0^b \phi^{-1}
    &= - \int_a^{\phi^{-1}(b)} \phi + b \phi^{-1}(b) \\
    &\geq - \int_a^{\phi^{-1}(b)} b + b \phi^{-1}(b) \\
    &= ab
\end{align*}


If $1 \leq p < +\infty$ and $\frac{1}{p} + \frac{1}{q} = 1$, then 
$\phi(x) = x^{p-1}$, then $\phi^{-1}(y) = y^{q-1}$. Moreover,
\[
    ab \leq \int_0^a x^{p-1} + \int_0^b y^{q-1} = \frac{a^p}{p} + \frac{b^q}{q}
\]


\begin{theorem}[Holder Inequality]
     Given a measurable space $(X, M, \mu)$ and $\mu$-measurable functions $f, g: X \to [-\infty, +\infty]$. If $1 \leq p \leq +\infty$ and $\frac{1}{p} + \frac{1}{q} = 1$, then
    \[
        ||fg||_1 \leq ||f||_p ||g||_q
    \]
\end{theorem}

Case 1: $p = 1$ or $p = +\infty$

\textcolor{red}{not interesting}

Case 2: $1 < p < +\infty$

If $||f||_p = 0$ (or $||g||_q = 0$), then $f = 0$ (or $g = 0$) almost everywhere, then both sides equal $0$. If $||f||_p = +\infty$ (or $||g||_q = +\infty$), then RHS equals $+\infty$. Hence, consider the case where both $||f||_p$, $||g||_q$ finite. We further assume that $||f||_p = 1$ and $||g||_q = 1$ (if not, divide both sides by $||f||_p ||g||_q$),

Then

\begin{align*}
    ||fg||_1
    &= \int_X |f||g| d\mu \\
    &\leq \int_X \left( \frac{|f|^p}{p} + \frac{|g|^q}{q} \right) d\mu \\
    &= \left( \frac{||f||_p^p}{p} + \frac{||g||_q^q}{q} \right) \\
    &= 1 = ||f||_p ||g||_q
\end{align*}

\begin{theorem}[Converse of Holder Inequality]
    Given a measurable space $(X, M, \mu)$ and $\mu$-measurable function $f: X \to [-\infty, +\infty]$, let $1 \leq p \leq +\infty$ and $\frac{1}{p} + \frac{1}{q} = 1$. Then
    \[
        ||f||_p = \sup_{||g||_q \leq 1} ||fg||_1
    \]
    where $f: X \to [-\infty, +\infty]$ is a $\mu$-measurable function. Moreover, 
    \[
        ||f||_p = \sup_{||g||_q \leq 1} ||fg||_1 = \sup_{||g||_q \leq 1} \int_X fg d\mu
    \]
\end{theorem}

From Holder Inequality,
\[
    ||f||_p \geq ||f||_p ||g||_q \geq ||fg||_1
\]
Hence,
\[
    ||f||_p \geq \sup_{||g||_q \leq 1} ||fg||_1
\]

Now, we will prove the converse: $||f||_p \leq \sup_{||g||_q \leq 1} ||fg||_1$

Case 1: $||f||_p = 0$, then $f = 0$ almost everywhere

\textcolor{red}{not interesting}

Case 2: $||f||_p$ finite

Assume $||f||_p = 1$ (if not, divide both sides by $||f||_p$). Pick $g = |f|^{p/q}$, then $||q||_q^q = \int_{X} |f|^{p} = ||f||_p^p = 1$. Furthermore,

\[
    ||fg||_1 = \int_X |f|^{p/q + 1} d\mu = \int_X |f|^p d\mu = ||f||_p^p = 1 = ||f||_p
\]
Hence,
\[
    ||f||_p \leq \sup_{||g||_q \leq 1} ||fg||_1
\]

Case 3: $||f||_p = +\infty$

Let $f_k, k \in \N$ be defined as 
\[
f_k(x) =
\begin{cases}
0 &\text{if $||x|| \geq k$}\\
\min\{|f(x)|, k\} &\text{if $||x|| < k$}\\
\end{cases}
\]

Each $f_k$ has $||f_k||_p$ finite, then there exists $g_k, ||g_k||_q = 1$ such that $||f_k g_k||_1 = ||f_k||_p$. Since $f_k \leq |f|$, we have $||f_k||_p \leq ||f_k g_k||_1 \leq ||f g_k||$. As $f_k \nearrow |f|$, then $||f_k||_p \nearrow ||f||_p$, $||f g_k||$ is arbitrary large. Then, 
\[
    +\infty = ||f||_p \leq \sup_{||g||_q \leq 1} ||fg||_1 = +\infty
\]


\begin{theorem}[Minkowski Inequality]
    Given a measurable space $(X, M, \mu)$ and $\mu$-measurable functions $f, g: X \to [-\infty, +\infty]$. If $1 \leq p \leq +\infty$, then
    \[
        ||f + g||_p \leq ||f||_p + ||g||_p
    \]
\end{theorem}

Case 1: $p = +\infty$

\textcolor{red}{not interesting}

Case 2: $1 \leq p < +\infty$ and $||f||_p = +\infty$ (or $||g||_p = +\infty$)

\textcolor{red}{not interesting}

Case 3: $1 \leq p < +\infty$ and both $||f||_p$ and $||g||_p$ finite

\begin{align*}
    ||f + g||_p^p
    &= \int_X |f+g|^p d\mu \\
    &= \int_X |f+g|^{p-1} |f+g| d\mu \\
    &\leq \int_X |f+g|^{p-1} (|f| + |g|) d\mu \\
    &= \int_X |f+g|^{p-1} |f| d\mu + \int_X |f+g|^{p-1} |g| d\mu \\
    &= || (|f+g|^{p-1} |f|) ||_1 + || (|f+g|^{p-1} |g|) ||_1 \\
    &\leq ||(f+g)^{p-1}||_q ||f||_p + ||(f+g)^{p-1}||_q ||g||_p &\text{(where $q > 0$ and $\frac{1}{p} + \frac{1}{q}$ = 1)}\\
    &= ||f+g||_p^{p-1} (||f||_p + ||g||_p)
\end{align*}

Hence,
\[
    ||f + g||_p \leq ||f||_p + ||g||_p
\]


\section{Banach Space, Metric Space}

\begin{definition}[Normed Space]
    Given a vector space $V$, a function $||\cdot||: V \to [0, +\infty)$ is said to be a norm if it satisfies the following
    \begin{itemize}
        \item Positive definiteness: $||x|| = 0$ if and only if $x = 0$
        \item Absolute homogeneity: $||\lambda x|| = |\lambda| ||x||$ for all $\lambda \in F$ and $x \in V$
        \item Triangle inequality: $||x + y|| \leq ||x|| + ||y||$ for all $x, y \in V$
    \end{itemize}
    If $||\cdot||$ satisfies only Absolute homogeneity and Triangle inequality, it is said to be a semi-norm. A vector space equipped with a norm is called a normed space.
\end{definition}

\begin{definition}[Complete Metric Space]
    A set $M$ equipped with a metric $d: M \times M \to [0, +\infty)$ is said to be a metric space if it satisfies the following
    \begin{itemize}
        \item Positive definiteness: $d(x, y) = 0$ if and only if $x = y$
        \item Symmetry: $d(x, y) = d(y, x)$ for all $x, y \in M$
        \item Triangle inequality: $d(x, z) \leq d(x, y) + d(y, z)$ for all $x, y, z \in M$
    \end{itemize}
    A sequence $x_1, x_2, ...$ ($x: \N \to X$) is said to be Cauchy if given any $\epsilon > 0$, there exists $N \in \N$ such that for all $m, n > N$ , then $d(x_m, x_n) < \epsilon$. A metric space $(X, d)$ is said to be complete if every Cauchy sequence converges.
\end{definition}

\begin{definition}[Banach Space - Complete Normed Space]
    A space $X$ is said to be a Banach space over the field $F$ if it satisfies the following
    \begin{itemize}
        \item $X$ is a normed space over $F$
        \item $X$ is a complete metric space induced by its norm, i.e. $d(x, y) = ||x-y||$
    \end{itemize}
\end{definition}

\begin{definition}[Separable Topological Space]
    A set $X$ equipped with a topology $\Tau \subseteq \Power(X)$ is said to be a topological space if it satisfies the following
    \begin{itemize}
        \item $\emptyset, X \in \Tau$
        \item $\bigcup_{i \in I} U_i \in \Tau$ if $U_i \in \Tau$ for all $i \in I$ where $I$ is any index set.
        \item $\bigcap_{n=1}^N U_i \in \Tau$ if $U_i \in \Tau$ for all $i = 1, 2, ..., N$ where $N \in \N$
    \end{itemize}
    A set in $\Tau$ is said to be an open set. Given a subset $E \subseteq X$, a point $x \in X$ is said to be a limit point of $E$ if any open neighbour of $x$ (open set containing $x$) contains a point in $E$ other than $x$. The union of $E$ and all of its limit points is said to be the closure of $E$, written as $\overline{E}$. A subset $E \subseteq X$ is said to be dense if $\overline{E} = X$. A topological space is said to be separable if it has a countable dense subset.
\end{definition}

\begin{definition}[Metric Space as a Topological Space]
    Given a metric space $(X, d)$, define a topology $\Tau$ consists of all open balls $\Ball_r(x)$ for all $x \in X$ and $r > 0$
\end{definition}

\begin{lemma}
    Given a measurable space $(X, M, \mu)$ and $\mu$-measurable functions $f, g: X \to [-\infty, +\infty]$. Then
    \begin{itemize}
        \item $||f + g||_p \leq ||f||_p + ||g||_p$ (if $1 \leq p \leq +\infty$)
        \item $||f + g||_p \leq K(||f||_p + ||g||_p)$ for $K > 0$ (if $0 < p < 1$)
    \end{itemize}
\end{lemma}

\begin{theorem}[Classification of $L^p$]
    Some classifications of $L^p$
    \begin{enumerate}
        \item if $0 < p < 1$, $L^p$ is a separable metric space with metric $d(f, g) = ||f - g||_p^p$ \label{lp:case1}
        \item if $1 \leq p < +\infty$, $L^p$ is a separable Banach space with norm $||f|| = ||f||_p$ \label{lp:case2}
        \item if $p = +\infty$, $L^p$ is a Banach space with norm $||f|| = ||f||_p$ \label{lp:case3}
    \end{enumerate}
\end{theorem}

\begin{lemma}
    $(a + b)^p \leq a^p + b^p$ if $a, b \geq 0$ and $0 < p < 1$
\end{lemma}

\[
    (a+b)^p = (a+b)^p \left(\frac{a}{a+b} + \frac{b}{a+b} \right) \leq (a+b)^p \left[ \left(\frac{a}{a+b}\right)^p + \left(\frac{b}{a+b}\right)^p \right] = a^p + b^p
\]

\begin{proposition}
    If $0 < p < 1$, $d(f, g) = ||f - g||_p^p$ is a metric 
\end{proposition}

\[
    ||f + g||_p^p = \int_X |f(x) + g(x)|^p d\mu \leq \int_X |f(x)|^q d\mu + \int_X |g(x)|^p d\mu \leq ||f||_p^p + ||g||_p^p
\]

\begin{proposition}
    If $1 \leq p < +\infty$, $L^p$ is complete.
\end{proposition}
Let $\{ f_k \}_{k \in \N}$ be a Cauchy sequence in $L^p$, that is given any $\epsilon > 0$, there exists a $N \in \N$ such that for all $m, n > N$, $||f_m - f_n||_p < \epsilon$. Hence, we can construct a subsequence $\{ f_{k_i} \}$ such that
\[
    \int_X |f_{k_i} - f_{k_{i-1}}| d\mu \leq \int_X |f_{k_i} - f_{k_{i-1}}|^p d\mu = ||f_{k_i} - f_{k_{i-1}}||_p^p < 2^i
\]
Put $g_i = \sum_{i=1}^n |f_{k_i} - f_{k_{i-1}}|$ and $g = \sum_{i=1}^\infty |f_{k_i} - f_{k_{i+1}}| = \lim_{i \to \infty} g_i$. By Fatou lemma, $\int_X g d\mu \leq \liminf_{i \to \infty} \int_X g_i d\mu \leq 1$. Hence, $g$ is finite almost everywhere.

Therefore, the following infinite series absolute converges for almost every $x \in X$
\[
    f(x) = f_{k_0}(x) + \sum_{i=1}^\infty (f_{k_i}(x) - f_{k_{i-1}}(x)) = \lim_{i \to \infty} f_{k_i}
\]

Now, we prove that $f$ is also a limit of $\{ f_k \}$ in $L^p$. As $|\cdot|^p$ is continous, $|f_{k_i} - f_k|^p \to |f - f_k|^p$, then by Fatou lemma
\[
    ||f - f_k||_p^p = \int_X |f - f_k|^p d\mu \leq \liminf_{i \to \infty} \int_X |f_{k_i} - f_k|^p d\mu
\]
Given any $\epsilon > 0$, pick $K$ large enough such that for all $k > K$, $\liminf_{i \to \infty} \int_X |f_{k_i} - f_k|^p d\mu < \epsilon^{1/p}$. We have the convergence in $L^p$. Furthermore, by Minkowski inequality
\[
    ||f||_p \leq ||f - f_k||_p + ||f_k||_p < +\infty
\]

\begin{proposition}
    $L^\infty$ is complete.
\end{proposition}

Let $\{ f_k \}_{k \in \N}$ be a Cauchy sequence in $L^\infty$. Let $Z_{k m n} = \{ x \in X: |f_k(x)| > ||f_k||_\infty \text{ and } |f_m(x) - f_n(x)| > ||f_m - f_n||_\infty \}$ with $\mu(Z_{k m n}) = 0$ and $E = X \setminus \bigcup_{(k, m, n) \in \N^3} Z_{k m n}$ with $\mu(E) = \mu(X)$. For each $x \in E$, $f_k(x)$ is a Cauchy sequence, hence $f_k(x) \to y < M$. Let $f: X \to \R$ be the bounded function where $f(x) = 0$ on $X \setminus E$ and $f_k(x) \to f(x)$ uniformly on $E$. Hence, $f$ is also a limit of $\{ f_k \}$ in $L^\infty$.

\begin{proposition}
    If $0 < p < +\infty$, $L^p$ is separable in $\R^n$ \footnote{probably true given $X$ $\sigma$-finite}
\end{proposition}

\textcolor{red}{not interesting}

\begin{theorem}[Continuity in $L^p(\R^n)$]
    If $f \in L^p(\R^n)$ given $0 < p < +\infty$, then
    \[
        \lim_{|h| \to 0} d(f(x + h), f(x)) = 0
    \]
    where $d(a, b) = ||a - b||_p$ for $1 \leq p < +\infty$ and $d(a, b) = ||a - b||_p^p$ for $0 < p < 1$
\end{theorem}

Outline of the proof
\begin{enumerate}
    \item Let $C^p$ be the set of functions satisfying the continuity conditions
    \item $C^p$ is a vector space
    \item $f \in C^p$ if $f_k \to f$ in $L^p$ ($||f_k - f|| \to 0$ as $k \to \infty$) and $f_k \in C^p, k \in \N$
    \item There is a dense set $D$ of $L^p$ belongs to $C^p$ (set of linear combinations of indicator functions of cubes)
    \item $C^p = L^p = \overline{D}$
\end{enumerate}

\chapter{Hilbert Space}

\begin{definition}[Inner Product Space]
    Given a vector space $V$ over field $F$, a function $\langle \cdot, \cdot \rangle: V \times V \to F$ is said to be an inner product if it satisfies the following
    \begin{itemize}
        \item Positive definiteness: $\langle x, x \rangle > 0$ and $\langle x, x \rangle = 0$ if and only if $x = 0$
        \item Conjugate Symmetry: $\langle x, y \rangle = \overline{\langle y, x \rangle}$ for all $x, y \in V$
        \item Additivity in the first argument: $\langle x + y, z \rangle = \langle x, z \rangle + \langle y, z \rangle$ for all $x, y, z \in V$
        \item Homogeneity in the first argument: $\langle \alpha x, y \rangle = \alpha \langle x, y \rangle$ for all $x, y \in V$ and $\alpha \in F$
    \end{itemize}
    A vector space equipped with an inner product is called an inner product space.
    Consequently, an inner product space is also a norm space where the norm is defined as $||x|| = |\langle x, x \rangle|$
\end{definition}

\begin{definition}[Hilbert Space]
    Hilbert Space is a Banach Space where the norm is induced from an inner product.
\end{definition}

\section{Orthogonality}

\begin{definition}[Linear Independence, Orthogonal, Orthogonal System, Span, Basis]
    Some definitions related to Hilbert Space:
    \begin{itemize}
        \item A collection of vectors $\{x_i: i \in I \}$ is said to be linearly independent if for any finite subcollection $J \subseteq I$, $\sum_{j \in J} a_j x_j = 0 \iff a_j = 0 \;\forall j \in J$
        \item Non-zero $x, y \in V$ are said to be orthogonal if $\langle x, y\rangle = 0$
        \item A set of non-zero pairwise orthogonal vectors is said to be an orthogonal system.
        \item An orthogonal system is said to be maximal (or complete) if no other vector is orthogonal to every vector in the system.
        \item Span of a collection of vectors is the set of all finite linear combinations.
        \item A collection of vectors is said to be a basis if its closure of span is the whole space.
    \end{itemize}
\end{definition}

\begin{theorem}
    Cardinality of any orthogonal system in a Hilbert Space is at most its density. In particular, any orthogonal system in a separable Hilbert Space is countable.
\end{theorem}

Assume $\{x_i: i \in I\}$ is orthonormal where $I$ is any index set. If $a \neq b$, then
\[
    ||x_a - x_b||^2 = |\langle x_a - x_b, x_a - x_b \rangle| = ||x_a||^2 + ||x_b||^2 = 2
\]

Hence, $||x_a - x_b|| < \sqrt{2}$. Let $B = \{ \Ball_{\sqrt{2}/2}(x_i): i \in I\}$ be a collection of disjoint balls centered at $x_i$. Let $D$ be a dense set, then for each $B_i \in B$, there is at least one element from $D$. By Axiom of Choice, we can construct a injection from $B$ to $D$. Hence, $\card(I) \leq \card(D)$

\begin{theorem}
    Any orthogonal system in a Hilbert Space is linearly independent.
\end{theorem}

Let $\{x_j: j \in J\}$ be finite orthonormal collection of vectors. Then

\[
    0 = \left\langle x_k, \sum_{j \in J} a_j x_j \right\rangle = a_k \langle x_k, x_k \rangle = a_k
\]

\begin{theorem}[Gram-Schmidt Process]
    Given a countable collection of vectors $\{ x_i \}, i \in \N $. There exists a countable orthogonal system $\{y_i \}$ defined by
    \begin{align*}
        y_1 &= x_1 \\
        y_2 &= a_{2 1} x_1 + x_2 \\
        ... \\
        y_k &= a_{k 1} x_1 + ... + a_{k k-1} x_{k-1} + x_k \\
        ...
    \end{align*}
\end{theorem}

\begin{theorem}
    An orthogonal system is maximal if and only if it is a basis.
\end{theorem}

Let $\{x_i: i \in I\}$ be an orthonormal basis, we will prove that it is maximal. Suppose there exists $y$ such that $\langle y, x_i \rangle$ for all $i \in I$ and $||y|| = 1$, then
\[
    1 = \langle y, y \rangle = \left\langle y, y - \sum_{j \in J} a_j x_j \right\rangle \leq ||y|| \cdot \left|\left| y - \sum_{j \in J} a_j x_j  \right|\right|
\]

for any finite subcollection $J \subseteq I$ and choice of $a_j$. Since $\{x_i: i \in I\}$ is a basis, RHS is arbitrary small. Hence, $\{x_i: i \in I\}$ is maximal.

On the other hand, let $\{x_i: i \in I\}$ be an maximal orthonormal system. Suppose, it is not a basis, that is, there exists $y$ and $\epsilon > 0$ such that
\[
    \left|\left| y - \sum_{j \in J} a_j x_j  \right|\right| > \epsilon
\]
for all finite subcollection $J \subseteq I$, and choice of $a_j$. Let $a_j = \langle y, x_i\rangle$ and $y_k = y - \sum_{j=1}^k a_j x_j$. We will prove that $y_k$ is a Cauchy sequence then converges. By Pythagorean theorem
\[
    ||y||^2 = ||y_k||^2 + ||\sum_{j=1}^k a_j x_j||^2 \geq ||\sum_{j=1}^k a_j x_j||^2 = \sum_{j=1}^k |a_j|^2
\]

for all $k \in \N$. The monotone increasing sequence $(\sum_{j=1}^k a_j^2)$ is bounded above, hence converges. Given any $m < n$, we have

\[
    ||y_m - y_n|| = ||\sum_{j=m+1}^n a_j x_j|| = \sqrt{\sum_{j=m+1}^n |a_j|^2}
\]

So, we can pick $N$ large enough such that $N < m < n$ and $||y_m - y_n||$ is arbitrary small. Let $y_k \to y_\infty$, by the assumption, $||y_\infty|| \geq ||y_k|| - ||y_k - y_\infty||$, then $||y_\infty|| \geq \epsilon$. We now prove that $y_\infty$ is orthogonal to all $x_i$ which leads to a contradiction. For any $x_i$, choose $k > i$ so that $y_k$ orthogonal to $x_i$
\[
    \langle y_\infty, x_i \rangle = \langle y_k + (y_\infty - y_k), x_i \rangle = \langle y_k , x_i \rangle + \langle y_\infty - y_k , x_i \rangle = \langle y_\infty - y_k , x_i \rangle \leq ||y_\infty - y_k|| ||x_i||
\]

By choosing $k$ large enough, we can make RHS arbitrary small. Hence, $\langle y_\infty, x_i \rangle = 0$

\begin{theorem}
    $L^P(\R^n)$ is a separable Hilbert Space and every basis is countably infinite.
\end{theorem}

\section{Fourier Series}

\begin{definition}[Fourier Series]
    Given an orthonormal system $\{x_i: i \in \N \}$ in a Hilbert space $H$ and $y \in H$, then the number
    \[
        c_i = \langle y, x_i\rangle
    \]
    is said to be the Fourier coefficient. The series
    \[
        S[y] = \sum_{i=1}^\infty c_i x_i
    \]
    is said to be the Fourier series
\end{definition}

\begin{theorem}
    Given an orthonormal system $\{x_i: i \in \N \}$ in a Hilbert space $H$ and $y \in H$. Given $N \in \N$, then 
    \[
        \min_{z \in \Span\{x_1, ..., x_N \}} ||y - z||^2 = ||y - S[y]||^2 = ||y|| - \sum_{i=1}^N |c_i|^2
    \]
    where $\{c_i: i \in \N \}$ are Fourier coefficients of $y$. Moreover, 
    \[
        \sum_{i=1}^\infty |c_i|^2 \leq ||y||^2
    \]
\end{theorem}

Let $z = \sum_{i=1}^N a_i x_i$, then 
\begin{align*}
    ||y - z||^2
    &= \langle y - z, y - z\rangle \\
    &= ||y||^2 - 2 \real(\langle y, z\rangle) + ||z||^2 \\
    &= ||y||^2 - 2 \real(\langle y, \sum_{i=1}^N a_i x_i\rangle) + ||z||^2 \\
    &= ||y||^2 + \sum_{i=1}^N \left[ - 2\real(\overline{a_i} c_i) + |a_i|^2 \right] \\ 
    &= ||y||^2 - \sum_{i=1}^N |c_i|^2 + \sum_{i=1}^N |a_i - c_i|^2 \\
    &\geq ||y||^2 - \sum_{i=1}^N |c_i|^2
\end{align*}

The equality holds when $a_i = c_i$. Let $y_k = \sum_{i=1}^k c_i x_i$, by Pythagorean theorem
\[
    ||y||^2 = ||y_k||^2 + ||y - y_k||^2
\]

Then $\sum_{i=1}^k |c_i|^2 = ||y_k||^2 \leq ||y||^2$ for all $k \in \N$. Hence, $\sum_{i=1}^\infty |c_i|^2 \leq ||y||^2$

\begin{proposition}[Parseval formula]
    Let $\{c_i: i \in \N \}$ be Fourier coefficients of $y$, then   $\sum_{i=1}^\infty |c_i|^2 = ||y||^2$ if and only if $y_k \to y$ where $y_k = \sum_{i=1}^k c_i x_i$
\end{proposition}

\[
    \lim_{k \to \infty} ||y - y_k||^2 = ||y||^2 - \lim_{k \to \infty} ||y_k||^2 = ||y||^2 - \sum_{i=1}^\infty |c_i|^2
\]



\begin{theorem}[Riesz-Fischer Theorem]
    Given an orthonormal system $\{x_i: i \in \N \}$ in a Hilbert space $H$ and $(a_1, a_2, ...) \in l^2$ ($\sum_{i=1}^\infty |a_i|^2 < +\infty$), then there exists $y \in H$ such that 
    $\langle y, x_i \rangle = a_i$ and $\sum_{i=1}^\infty |a_i|^2 = ||y||^2$
\end{theorem}

Let $y_k = \sum_{i=1}^k a_i x_i$. We will prove that $\{y_k: k \in \N \}$ is a Cauchy sequence. Given any $m < n$,
\[
    ||y_n - y_m||^2 = \sum_{i=m+1}^n |a_i|^2
\]
As $\sum_{i=1}^\infty |a_i|^2 < +\infty$, we can choose $N$ large enough such that the RHS is arbitrary small for all $m, n > N$. Hence, $\{y_k: k \in \N \}$ is a Cauchy sequence. Let $y_k \to y$, for any $x_i$, choose $k > i$
\[
    \langle y, x_i \rangle = \langle y_k + (y - y_k), x_i \rangle = \langle y_k, x_i \rangle + \langle y - y_k, x_i \rangle = a_i + \langle y - y_k, x_i \rangle
\]

we can choose $k$ large enough such that $|\langle y, x_i \rangle - a_i|$ arbitrary small. Hence, $\langle y, x_i \rangle = a_i$. By Pythagorean theorem \footnote{$\langle y - y_k, y_k\rangle = \langle y, y_k\rangle - \langle y_k, y_k\rangle = \langle y, \sum_{i=1}^k a_i x_i\rangle - \sum_{i=1}^k |a_i|^2 = 0$},

\[
    ||y||^2 = ||y_k + (y - y_k)||^2 = ||y_k||^2 + ||y - y_k||^2 = \sum_{i=1}^k |a_i|^2 + ||y - y_k||^2
\]

Then 
\[
    \sum_{i=1}^\infty |a_i|^2 = ||y||^2 - \lim_{k \to \infty} ||y - y_k||^2 = ||y||^2
\]

\begin{theorem}
    \label{theorem18}
    Given an orthonormal system $\{x_i: i \in \N \}$ in a Hilbert space $H$. $\{x_i: i \in \N \}$ is a basis if and only if for every $y \in H$, $y_k \to y$ where $y_k = \sum_{i=1}^k c_i x_i$ and $c_i = \langle y, x_i \rangle$
\end{theorem}

For every $y \in H$, $y_k \to y$, then $\{x_i: i \in \N \}$ is dense. On the other hand, let $\{x_i: i \in \N \}$ be a basis but $y_k \to y_\infty$ and $||y - y_\infty|| > 0$, then $y - y_\infty$ is orthogonal to all $x_i$. Choose $k > i$

\[
    \langle y - y_\infty, x_i \rangle = \langle (y - y_k) + (y_k - y_\infty) , x_i \rangle = \langle y - y_k, x_i \rangle + \langle y_k - y_\infty, x_i \rangle \leq ||y_k - y_\infty|| ||x_i||
\]
Choose $k$ large enough make RHS arbitrary small. Contradiction

\begin{definition}[Isometry - Isomorphism of Metric Space]
    Two metric spaces $A, B$ are isometric if there exists a bijection $T: A \to B$ such that it preserves distance, i.e. $d_B(T(x), T(y)) = d_A(x, y)$ for all $x, y \in A$
\end{definition}

\begin{lemma}
    All vector spaces have a basis
\end{lemma}

Prove using Zorn lemma

\begin{theorem}
    All separable Hilbert spaces are linearly isometric
\end{theorem}
Given a separable Hilbert space $H$, we will prove that it is isometric to $l^2$. Given a basis of $H$, using Gram-Schmidt Process, we can construct an orthonormal basis $\{x_i: i \in \N \}$

Let $(a_1, a_2, ...) \in l^2$ and the map $T(a_1, a_2, ...) = y$ where $y_k \to y$ with $y_k = \sum_{i=1}^k a_i x_i$.

$T$ is one-to-one. Suppose $T(a_1, a_2, ...) = T(b_1, b_2, ...) = y$ with $a_i \neq b_i$. By Riesz-Fischer Theorem, $a_i = \langle y, x_i \rangle = b_i$. Contradiction

$T$ is onto. By theorem \ref{theorem18}, for any $y \in H$ the sequence of Fourier coefficients $(c_1, c_2, ...)$ satisfies $y_k \to y$  with $y_k = \sum_{i=1}^k c_i x_i$.

$T$ is an isometry. Let $y = T(a_1, a_2, ...)$, $z = T(b_1, b_2, ...)$

\[
||y - z||^2 = ||\sum_{i=1}^\infty (a_i - b_i) x_i|| = \sum_{i=1}^\infty (a_i - b_i)^2 = ||(a_1, a_2, ...) - (b_1, b_2, ...)||^2
\]

$T$ is linear. 

\textcolor{red}{not interesting}

\chapter{Approximation of Identity}

\begin{definition}[Convolution]
    Given $f, g$ measurable on $X$, define convolution
    \[
        (f * g)(x) = \int_X f(t) g(x-t) dt
    \]
    provided the integral exists.
\end{definition}

\begin{theorem}[Young Convolution Theorem]
    Let $1 \leq p, q \leq +\infty$ and $\frac{1}{p} + \frac{1}{q} \geq 1$ and let $\frac{1}{r} = \frac{1}{p} + \frac{1}{q} - 1$. If $f \in L^p$ and $g \in L^q$, then $f * g \in L^r$ and 
    \[
        ||f * g||_r \leq ||f||_p ||g||_q
    \]
    Moreover, theorem still holds if we relax either $f \in L^p$ or $g \in L^q$ to weak-type.
\end{theorem}

\begin{definition}[Partial derivative]
    $C^m$ denotes the class of functions whose partial derivatives of order $m$ exist and continuous. $C^m_0$ denotes a subset of $C^m$ with compact support. Similar notations $C^\infty, C^\infty_0$ for infinitely differentiable function.

    Let $\alpha = (\alpha_1, ..., \alpha_n), \sum_{i=1}^n \alpha \leq m$, denote the $\alpha$ partial derivative of $f \in C^m$ as
    \[
        (D^\alpha f)(x) = \left(\frac{\partial^\alpha f}{\partial x^\alpha} \right)(x) = \left( \frac{\partial^{\alpha_1}}{\partial {x_1}^{\alpha_1}} ... \frac{\partial^{\alpha_n}}{\partial {x_n}^{\alpha_n}}\right)(x)
    \]
\end{definition}

\begin{theorem}
    If $1 \leq p \leq +\infty$, $f \in L^p$ and $K \in C^m_0$, then $f * K \in C^m$ with bounded partial derivatives of all orders at most $m$ and
    \[
        D^\alpha (f * K)(x) = (f * D^\alpha K) (x)
    \]
    where $\alpha = (\alpha_1, ..., \alpha_n), \sum_{i=1}^n \alpha \leq m$
\end{theorem}

\textcolor{red}{todo}




\begin{definition}[Approximation of Identity]
The ring of measurable functions on $X$ with usual addition and convolution as the multiplication is a ring without unity, i.e. there is no $e: X \to [-\infty, +\infty]$ such that $f * e = e * f = f$ for all $f: X \to [-\infty, +\infty]$. We instead approximate the identity by a kernel $K$. Given $K(x)$ and $\epsilon > 0$, let
\[
    K_\epsilon(x) = \epsilon^{-n} K\left( \frac{x}{\epsilon} \right)
\]    
\end{definition}

\begin{lemma}
    If $K \in L^1(\R^n)$ and $\epsilon > 0$, then 
    \begin{enumerate}
        \item $\int K_\epsilon = \int K$
        \item $\lim_{\epsilon \to 0^+} \int_{|x| > \delta} |K_\epsilon| = 0$ for any fixed $\delta$
    \end{enumerate}
\end{lemma}

By change of variables $T: \R^n \to \R^n$ defined by $y = T(x) = \frac{x}{\epsilon}$

\[
    \int_{\R^n} K_\epsilon(y) dy = \int_{T^{-1}(\R^n)} K_\epsilon(T(x)) |(\det T)(x)| dx = \int_{\R^n} K(x) dx
\]

Similarly,
\[
    \int_{|x| > \delta} |K_\epsilon(y)| dy = \int_{|x| > \delta/\epsilon} |K(x)| dx
\]

As $\int_{\R^n} |K(x)| dx < +\infty$, by monotonicity, $lim_{\epsilon \to 0^+} \int_{|x| > \delta} |K_\epsilon| = 0$

\begin{theorem}
    Let $f_\epsilon = f * K_\epsilon$ where $K \in L^1(\R^n)$ and $\int K = 1$. If $f \in L^p(\R^n), 1 \leq p < +\infty$, then 
    \[
        \lim_{\epsilon \to 0} ||f_\epsilon - f||_p = 0 
    \]
\end{theorem}

If $1 < p < +\infty$, then
\begin{align*}
    |f_\epsilon(x) - f(x)|
    &= \left| \int f(x-t) K_\epsilon(t) dt - f(x) \right| \\
    &= \left| \int [f(x-t) - f(x)] K_\epsilon(t) dt \right| \\
    &\leq \int |f(x-t) - f(x)| |K_\epsilon(t)| dt &\text{(analogous to triangle inequality)}\\
    &= \int |f(x-t) - f(x)| |K_\epsilon(t)|^{1/p} |K_\epsilon(t)|^{1/q} dt &\text{$\left( \frac{1}{p} + \frac{1}{q} = 1\right)$} \\
    &= \left|\left| \left(|f(x-t) - f(x)| |K_\epsilon(t)|^{1/p}\right) \left(|K_\epsilon(t)|^{1/q} \right) \right|\right|_1 &\text{(norm as a function of $t$)}\\
    &\leq \left|\left| |f(x-t) - f(x)| |K_\epsilon(t)|^{1/p} \right|\right|_p \left|\left| |K_\epsilon(t)|^{1/q}\right|\right|_q &\text{(Holder inequality for $p, q$, norm as a function of $t$)} \\
    &= \left(\int |f(x-t) - f(x)|^p |K_\epsilon(t)| dt \right)^{1/p} \left( \int |K_\epsilon(t)| dt \right)^{1/q} \\
    &= \left(\int |f(x-t) - f(x)|^p |K_\epsilon(t)| dt \right)^{1/p} 
\end{align*}

We also have the same inequality if $p = 1$ (\textcolor{red}{not interested}). Therefore,

\begin{align*}
    ||f_\epsilon - f||_p^p
    &= \int |f_\epsilon(x) - f(x)|^p dx \\
    &\leq \int \left( \int |f(x-t) - f(x)|^p |K_\epsilon(t)| dt \right) dx \\
    &= \int \left( \int |f(x-t) - f(x)|^p |K_\epsilon(t)| dx \right) dt &\text{(Tonelli theorem)} \\
    &= \int |K_\epsilon(t)| \left( \int |f(x-t) - f(x)|^p  dx \right) dt
\end{align*}

Let $\phi(t) = \int |f(x-t) - f(x)|^p  dx = || f(x - t) - f(x) ||_p^p$ (norm as a function of $x$), by continuity of $L^p$ function, $f \in L^p(\R^n), 1 \leq p \leq +\infty$, for any $\eta > 0$, there exists $\delta > 0$ such that $|t| < \delta$ then $\phi(t) < \eta$. We have

\begin{align*}
    ||f_\epsilon - f||_p^p
    &\leq \int |K_\epsilon(t)| \phi(t) dt \\
    &= \int_{|t| < \delta} |K_\epsilon(t)| \phi(t) dt + \int_{|t| \geq \delta} |K_\epsilon(t)| \phi(t) dt \\
    &\leq \eta \int_{|t| < \delta} |K_\epsilon(t)| dt + \int_{|t| \geq \delta} |K_\epsilon(t)| \phi(t) dt &\text{(continuity of $L^p$)} \\
    &\leq \eta M + \int_{|t| \geq \delta} |K_\epsilon(t)| \phi(t) dt &\text{$\left(\int_{|t| < \delta} |K_\epsilon(t)| dt \leq \int |K_\epsilon(t)| dt = M < +\infty \right)$} \\
    &\leq \eta M + 2^p||f||_p^p \int_{|t| \geq \delta} |K_\epsilon(t)| dt &\text{($|| f(x - t) - f(x) ||_p^p \leq (||f(x-t)||_p + ||f(x)||_p)^p = 2^p||f||_p^p$)} \\
\end{align*}

As $\lim_{\epsilon \to 0} \int_{|t| \geq \delta} |K_\epsilon(t)| dt = 0$, we can make $||f_\epsilon - f||_p^p$ arbitrarily small

\section{Marcinkiewicz Interpolation Theorem}

\begin{definition}[Weak-$L^p$]
    A measurable function on $X$ is said to belong to weak $L^p(X), 0 < p < \infty$ if there is a constant $A \geq 0$ such that $\mu \set{x \in X: f(x) > \alpha} \leq \frac{A}{\alpha^p}$.
    Some properties of weak $L^p$
    \begin{itemize}
        \item if $f \in L^p$, then $f \in$ weak-$L^p$
        \item if $f \in \text{weak }L^1$ and $f \in \text{weak }L^r$, then $f \in L^p$ with $1 < r < p < \infty$
    \end{itemize}
\end{definition}


\begin{theorem}[Marcinkiewicz Interpolation Theorem]
    Given a operator $T$ that is sublinear \footnote{can be generalized to $|T(f + g)(x)| \leq c(|Tf(x)| + |Tg(x)|)$}, that is
    \[
        |T(f + g)(x)| \leq |Tf(x)| + |Tg(x)|
    \]
    almost everywhere. Then, for any $p < r < q$, if $T$ maps $L^{p}$ into weak-$L^{p}$ and $T$ maps a $L^{q}$ into a weak-$L^{q}$. Then, $T$ maps $L^r$ into a $L^r$.
\end{theorem}

Given any function $f$ and any $\alpha > 0$, define the following

\begin{itemize}
    \item $f^\alpha = \chi_{\set{|f| > \alpha}} f$
    \item $f_\alpha = \chi_{\set{|f| \leq \alpha}} f$
\end{itemize}

Then, $f = f^\alpha + f_\alpha$. By sublinearity of $T$,
\[
    |Tf(x)| \leq |Tf^\alpha(x)| + |Tf_\alpha(x)|
\]

almost everywhere. Then
\[
    \set{|Tf| > \alpha} \subseteq \set{|Tf^\alpha| > \alpha/2} \cup \set{|Tf_\alpha| > \alpha/2}
\]

By sublinearity of measure,
\[
    \mu \set{|Tf| > \alpha} \leq \mu \set{|Tf^\alpha| > \alpha/2} + \mu \set{|Tf_\alpha| > \alpha/2}
\]

Now, we write the $L_r$ norm of $Tf$

\begin{align*}
    ||Tf||_r^r
    &= \int |Tf(x)|^r dx \\
    &= r \int_0^{+\infty} \alpha^{r-1} \mu \set{|Tf| > \alpha} d\alpha \\
    &\leq r \int_0^{+\infty} \alpha^{r-1} \mu \set{|Tf^\alpha| > \alpha/2} d\alpha + r \int_0^{+\infty} \alpha^{r-1} \mu \set{|Tf_\alpha| > \alpha/2} d\alpha\\
\end{align*}

We will prove that each term is bounded given $||f||_r$ finite. For the second term, pick $\alpha$ small enough such that for all $x \in [0, \alpha]$, $x^q < x^r$. Then $f \in L^r \implies f_\alpha \in L^r \implies f_\alpha \in L^q$. As $T$ maps $L^q$ to weak-$L^q$, we have
\[
    \mu \set{|Tf_\alpha| > \alpha/2} \leq c \alpha^{-q} ||f_\alpha||_q^q
\]

for some constant $c$. Then
\begin{align*}
    \int_0^{+\infty} \alpha^{r-1} \mu \set{|Tf_\alpha| > \alpha/2} d\alpha
    &\leq c \int_0^{+\infty} \alpha^{r-1} \alpha^{-q} \tuple*{\int \chi_{\set{|f| \leq \alpha}} |f(x)|^q dx} d\alpha \\
    &= c \int |f(x)|^q \tuple*{\int_0^{+\infty} \alpha^{-(q-r)-1} \chi_{\set{|f| \leq \alpha}} d\alpha} dx &\text{(Tonelli theorem)} \\
    &= c \int |f(x)|^q \tuple*{\int_{|f(x)|}^{+\infty} \alpha^{-(q-r)-1} d\alpha} dx \\
    &= c \int |f(x)|^q \frac{1}{(q-r) |f(x)|^{q-r}} dx \\
    &= \frac{c}{q-r} \int |f(x)|^r dx \\
\end{align*}

For the first term, $f \in L^r \implies f^\alpha \in L^r \implies f^\alpha \in L^p$. As $T$ maps $L^p$ to weak-$L^p$, we have

\[
    \mu \set{|Tf^\alpha| > \alpha/2} \leq c \alpha^{-p} ||f_\alpha||_p^p
\]

for some constant $c$. Then

\begin{align*}
    \int_0^{+\infty} \alpha^{r-1} \mu \set{|Tf^\alpha| > \alpha/2} d\alpha
    &\leq c \int_0^{+\infty} \alpha^{r-1} \alpha^{-p} \tuple*{\int \chi_{\set{|f| > \alpha}} |f(x)|^p dx} d\alpha \\
    &= c \int |f(x)|^p \tuple*{\int_0^{+\infty} \alpha^{(r-p)-1} \chi_{\set{|f| > \alpha}} d\alpha } dx \\
    &= c \int |f(x)|^p \tuple*{\int_0^{|f(x)|} \alpha^{(r-p)-1} d\alpha } dx \\
    &= c \int |f(x)|^p \frac{|f(x)|^{r-p}}{r-p} dx \\
    &= \frac{c}{r-p} \int |f(x)|^r dx
\end{align*}

\end{document}